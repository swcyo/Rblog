geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C'),c('C-kit-N','C-kit-D'))
)
ggplot(KIT ,
aes(x=GENE,y=value,color=GENE,fill=GENE))+
geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C'),c('C-kit-N','C-kit-D'))
)
ggplot(KIT ,
aes(x=GENE,y=value,color=GENE,fill=GENE))+
geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C'),c('C-kit-N','C-kit-D')))
ggplot(KIT ,
aes(x=GENE,y=value,color=GENE,fill=GENE))+
geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()+
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C'),c('C-kit-N','C-kit-D'))
)
ggplot(KIT ,
aes(x=GENE,y=value,color=GENE,fill=GENE))+
geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()+
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C')))
ggplot(KIT ,
aes(x=GENE,y=value,color=GENE,fill=GENE))+
geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()+
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C')))+theme_bw()
ggplot(KIT ,
aes(x=GENE,y=value,color=GENE,fill=GENE))+
geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()+
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C')))+theme_bw()+theme(legend='none')
ggplot(KIT ,
aes(x=GENE,y=value,color=GENE,fill=GENE))+
geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()+
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C')))+theme_bw()+ggtitle("C-kit")
KIT <- within(KIT, GENE <- factor(GENE, levels = c("C-kit-N", "C-kit-A",'C-kit-B','C-kit-C')))
ggplot(KIT ,
aes(x=GENE,y=value,color=GENE,fill=GENE))+
geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()+
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C')))+theme_bw()
ggplot(KIT ,
aes(x=GENE,y=value,color=GENE,fill=GENE))+
geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()+
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C')))+theme_bw()+theme(legend.title = 'none')
ggplot(KIT ,
aes(x=GENE,y=value,color=GENE,fill=GENE))+
geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()+
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C')))+theme_bw()
ggplot(KIT ,
aes(x=GENE,y=value,color=GENE,fill=GENE))+
geom_bar(stat="summary",fun=mean,position="dodge")+
stat_summary(fun.data = 'mean_sd', geom = "errorbar", width = 0.5,position = position_dodge(0.9))+
theme_minimal(base_size = 12)+
labs(x=NULL,y='Relative protein expression')+
scale_color_lancet()+
scale_fill_lancet()+
geom_dotplot(stackdir = "center", binaxis = "y",
fill = "lightgray",
dotsize = 0.9,position = position_dodge(0.9))+
stat_compare_means(method = "anova")+
stat_compare_means(method = 't.test',label = "p.signif",comparisons = list(c('C-kit-N','C-kit-A'),c('C-kit-N','C-kit-B'),c('C-kit-N','C-kit-C')))+theme_bw()+
ggtitle("C-Kit")
library(ggstatsplot)
ggbetweenstats(KIT,GENE,value)
ggbarstats(KIT,GENE,value)
ggbarstats(KIT,GENE,value,paired = T)
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
library(AnnoProbe)
gse13507<-geoChina("GSE13507")
View(gse13507)
geo=gse13507[[1]]
View(geo)
library(tinyarray)
geo13507 = geo_download("GSE13507",
destdir=tempdir(),
by_annopbrobe = T  ### 默认为F，设置为T调用AnnoProbe
)
remove(gse13507)
View(geo13507)
geo=geo13507$exp
View(geo)
ph=geo13507$pd
View(ph)
rm(list = ls())
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
data<-readxl::read_xlsx('http://www.bioinformatics.com.cn/static/sample_data/046_sample_data.xlsx')
data<-readxl::read_xlsx('/Users/mac/Documents/GitHub/Rblog/content/zh/course/2022-03-01-long-short/046_sample_data.xlsx')
View(data)
data<-readxl::read_xlsx('/Users/mac/Documents/GitHub/Rblog/content/zh/course/2022-03-01-long-short/046_sample_data.xlsx')
View(data)
View(data)
knitr::kable(data,caption = "data")
data(geneList)
library(DOSE)
data(geneList)
de = names(geneList)[1:1000]
library(clusterProfiler)
x = enrichKEGG(gene= de,organism= 'hsa',pvalueCutoff = 1,  use_internal_data =T)
dotplot(x)
barplot(x)
View(x)
df<-data.frame(x)
View(df)
library(ggplot2) # 画图工具
library(dplyr) # 提数据工具
## 设定显示的数目
showCategory =4
## 设定字体的大小
font.size =12
data %>%
## 按照p值排序，选区既定数目的行
arrange(Pvalue) %>%
slice(1:showCategory) %>%
## 开始ggplot2 作图，其中fct_reorder调整因子level的顺序
ggplot(aes(x=forcats::fct_reorder(Term,Pvalue,.desc = T),y=Count,fill=Pvalue))+
## 画出bar图
geom_bar(stat="identity")+
coord_flip()+
## 调整颜色，guide_colorbar调整色图的方向
scale_fill_continuous(low="red", high="blue", guide=guide_colorbar(reverse=TRUE))+
## 如果用ylab("")或出现左侧空白
labs(x=NULL,y=NULL) +
## 如果没有这一句，上方会到顶
ggtitle("")+
## 设定主题
theme_bw() +
theme(axis.text.x = element_text(colour = "black",
size = font.size, vjust =1 ),
axis.text.y = element_text(colour = "black",
size = font.size, hjust =1 ),
axis.title = element_text(margin=margin(10, 5, 0, 0),
color = "black",size = font.size),
axis.title.y = element_text(angle=90))
showCategory =12
data %>%
## 按照p值排序，选区既定数目的行
arrange(Pvalue) %>%
slice(1:showCategory) %>%
## 开始ggplot2 作图，其中fct_reorder调整因子level的顺序
ggplot(aes(x=forcats::fct_reorder(Term,Pvalue,.desc = T),y=Count,fill=Pvalue))+
## 画出bar图
geom_bar(stat="identity")+
coord_flip()+
## 调整颜色，guide_colorbar调整色图的方向
scale_fill_continuous(low="red", high="blue", guide=guide_colorbar(reverse=TRUE))+
## 如果用ylab("")或出现左侧空白
labs(x=NULL,y=NULL) +
## 如果没有这一句，上方会到顶
ggtitle("")+
## 设定主题
theme_bw() +
theme(axis.text.x = element_text(colour = "black",
size = font.size, vjust =1 ),
axis.text.y = element_text(colour = "black",
size = font.size, hjust =1 ),
axis.title = element_text(margin=margin(10, 5, 0, 0),
color = "black",size = font.size),
axis.title.y = element_text(angle=90))
data %>%
## 按照p值排序，选区既定数目的行
arrange(Pvalue) %>%
slice(1:showCategory) %>%
## 开始ggplot2 作图，其中fct_reorder调整因子level的顺序
ggplot(aes(x=forcats::fct_reorder(Term,Pvalue,.desc = T),y=Count,fill=Pvalue))+
## 画出bar图
geom_bar(stat="identity")+
coord_flip()+
## 调整颜色，guide_colorbar调整色图的方向
scale_fill_continuous(low="red", high="blue", guide=guide_colorbar(reverse=TRUE))+
## 如果用ylab("")或出现左侧空白
labs(x=NULL) +
## 如果没有这一句，上方会到顶
ggtitle("")+
## 设定主题
theme_bw() +
theme(axis.text.x = element_text(colour = "black",
size = font.size, vjust =1 ),
axis.text.y = element_text(colour = "black",
size = font.size, hjust =1 ),
axis.title = element_text(margin=margin(10, 5, 0, 0),
color = "black",size = font.size),
axis.title.y = element_text(angle=90))
View(data)
data %>%
## 按照p值排序，选区既定数目的行
arrange(Pvalue) %>%
slice(1:showCategory) %>%
ggplot(aes(x=forcats::fct_reorder(Term,Pvalue,.desc = T),y=Count,fill=Pvalue))+
## 画出bar图
geom_bar(stat="identity")+
coord_flip()+
## 调整颜色，guide_colorbar调整色图的方向
scale_fill_continuous(low="red", high="blue", guide=guide_colorbar(reverse=TRUE))+
## 如果用ylab("")或出现左侧空白
labs(x=NULL) +
## 如果没有这一句，上方会到顶
ggtitle("")+
## 设定主题
theme_bw() +
theme(axis.text.x = element_text(colour = "black",
size = font.size, vjust =1 ),
axis.text.y = element_text(colour = "black",
size = font.size, hjust =1 ),
axis.title = element_text(margin=margin(10, 5, 0, 0),
color = "black",size = font.size),
axis.title.y = element_text(angle=90))
data %>%
## 按照p值排序，选区既定数目的行
arrange(Pvalue) %>%
slice(1:showCategory) %>%
## 开始ggplot2 作图，其中fct_reorder调整因子level的顺序
ggplot(aes(x=forcats::fct_reorder(Term,Pvalue,.desc = T),y=Count,fill=Pvalue))+
## 画出bar图
geom_bar(stat="identity")+
coord_flip()+
## 调整颜色，guide_colorbar调整色图的方向
scale_fill_continuous(low="red", high="blue", guide=guide_colorbar(reverse=TRUE))+
## 如果用ylab("")或出现左侧空白
labs(x=NULL) +
## 如果没有这一句，上方会到顶
ggtitle("")+
## 设定主题
theme_bw() +
theme(axis.text.x = element_text(colour = "black",
size = font.size, vjust =1 ),
axis.text.y = element_text(colour = "black",
size = font.size, hjust =1 ),
axis.title = element_text(margin=margin(10, 5, 0, 0),
color = "black",size = font.size),
axis.title.y = element_text(angle=90))+facet_grid(group~., scale = "free")
p<-data %>%
## 按照p值排序，选区既定数目的行
arrange(Pvalue) %>%
slice(1:showCategory) %>%
## 开始ggplot2 作图，其中fct_reorder调整因子level的顺序
ggplot(aes(x=forcats::fct_reorder(Term,Pvalue,.desc = T),y=Count,fill=Pvalue))+
## 画出bar图
geom_bar(stat="identity")+
coord_flip()+
## 调整颜色，guide_colorbar调整色图的方向
scale_fill_continuous(low="red", high="blue", guide=guide_colorbar(reverse=TRUE))+
## 如果用ylab("")或出现左侧空白
labs(x=NULL) +
## 如果没有这一句，上方会到顶
ggtitle("")+
## 设定主题
theme_bw() +
theme(axis.text.x = element_text(colour = "black",
size = font.size, vjust =1 ),
axis.text.y = element_text(colour = "black",
size = font.size, hjust =1 ),
axis.title = element_text(margin=margin(10, 5, 0, 0),
color = "black",size = font.size),
axis.title.y = element_text(angle=90))
p
library(stringr)
p + scale_x_discrete(labels=function(x) str_wrap(x, width=10))
p1<-p+ facet_grid(group~., scale = "free")
p1 + scale_x_discrete(labels=function(x) str_wrap(x, width=10))
p1 + scale_x_discrete(labels=function(x) str_wrap(x, width=20))
sum(data$Count)
14/266
data$sum<-sum(data$Count)
data$generation<-data$Count/sum(data$Count)
within(data, GeneRatio <- paste(Count, sum, sep='/'))
View(data)
data$GeneRatio = paste(data$Count, data$generation, sep="/")
data$GeneRatio = paste(data$Count, data$sum, sep="/")
data$GeneRatio2 = paste(data$Count, sum(data$Count), sep="/")
rm(list = ls())
data<-readxl::read_xlsx('/Users/mac/Documents/GitHub/Rblog/content/zh/course/2022-03-01-long-short/046_sample_data.xlsx')
data$GeneRatio = paste(data$Count, sum(data$Count), sep="/")
knitr::kable(data,caption = "添加GeneRatio列")
View(data)
forward <- as.numeric(sub("/\\d+$", "", data$GeneRatio))
backward <- as.numeric(sub("^\\d+/", "", data$GeneRatio))
## 增加数值表示的一列GeneRatio
data$GeneRatio = forward/backward
data$GeneRatio = data$Count/sum(data$Count)
y %>%
## 按照p值排序，选区既定数目的行
arrange(Pvalue) %>%
slice(1:showCategory) %>%
## 开始ggplot2 作图，其中fct_reorder调整因子level的顺序
ggplot(aes(GeneRatio,forcats::fct_reorder(Term,Count)))+
## 画出点图
geom_point(aes(color=Pvalue, size = Count)) +
## 调整颜色，guide_colorbar调整色图的方向
scale_color_continuous(low="red", high="blue", guide=guide_colorbar(reverse=TRUE))+
## 调整泡泡的大小
scale_size_continuous(range=c(3, 8))+ ### 这里可以改点的大小
## 如果用ylab("")或出现左侧空白
labs(y=NULL) +
## 如果没有这一句，上方会到顶
ggtitle("")+
## 设定主题
theme_bw() +
theme(axis.text.x = element_text(colour = "black",
size = font.size, vjust =1 ),
axis.text.y = element_text(colour = "black",
size = font.size, hjust =1 ),
axis.title = element_text(margin=margin(10, 5, 0, 0),
color = "black",size = font.size),
axis.title.y = element_text(angle=90))
data %>%
## 按照p值排序，选区既定数目的行
arrange(Pvalue) %>%
slice(1:showCategory) %>%
## 开始ggplot2 作图，其中fct_reorder调整因子level的顺序
ggplot(aes(GeneRatio,forcats::fct_reorder(Term,Count)))+
## 画出点图
geom_point(aes(color=Pvalue, size = Count)) +
## 调整颜色，guide_colorbar调整色图的方向
scale_color_continuous(low="red", high="blue", guide=guide_colorbar(reverse=TRUE))+
## 调整泡泡的大小
scale_size_continuous(range=c(3, 8))+ ### 这里可以改点的大小
## 如果用ylab("")或出现左侧空白
labs(y=NULL) +
## 如果没有这一句，上方会到顶
ggtitle("")+
## 设定主题
theme_bw() +
theme(axis.text.x = element_text(colour = "black",
size = font.size, vjust =1 ),
axis.text.y = element_text(colour = "black",
size = font.size, hjust =1 ),
axis.title = element_text(margin=margin(10, 5, 0, 0),
color = "black",size = font.size),
axis.title.y = element_text(angle=90))
showCategory =12
data %>%
## 按照p值排序，选区既定数目的行
arrange(Pvalue) %>%
slice(1:showCategory) %>%
## 开始ggplot2 作图，其中fct_reorder调整因子level的顺序
ggplot(aes(GeneRatio,forcats::fct_reorder(Term,Count)))+
## 画出点图
geom_point(aes(color=Pvalue, size = Count)) +
## 调整颜色，guide_colorbar调整色图的方向
scale_color_continuous(low="red", high="blue", guide=guide_colorbar(reverse=TRUE))+
## 调整泡泡的大小
scale_size_continuous(range=c(3, 8))+ ### 这里可以改点的大小
## 如果用ylab("")或出现左侧空白
labs(y=NULL) +
## 如果没有这一句，上方会到顶
ggtitle("")+
## 设定主题
theme_bw() +
theme(axis.text.x = element_text(colour = "black",
size = font.size, vjust =1 ),
axis.text.y = element_text(colour = "black",
size = font.size, hjust =1 ),
axis.title = element_text(margin=margin(10, 5, 0, 0),
color = "black",size = font.size),
axis.title.y = element_text(angle=90))
font.size =12
data %>%
## 按照p值排序，选区既定数目的行
arrange(Pvalue) %>%
slice(1:showCategory) %>%
## 开始ggplot2 作图，其中fct_reorder调整因子level的顺序
ggplot(aes(GeneRatio,forcats::fct_reorder(Term,Count)))+
## 画出点图
geom_point(aes(color=Pvalue, size = Count)) +
## 调整颜色，guide_colorbar调整色图的方向
scale_color_continuous(low="red", high="blue", guide=guide_colorbar(reverse=TRUE))+
## 调整泡泡的大小
scale_size_continuous(range=c(3, 8))+ ### 这里可以改点的大小
## 如果用ylab("")或出现左侧空白
labs(y=NULL) +
## 如果没有这一句，上方会到顶
ggtitle("")+
## 设定主题
theme_bw() +
theme(axis.text.x = element_text(colour = "black",
size = font.size, vjust =1 ),
axis.text.y = element_text(colour = "black",
size = font.size, hjust =1 ),
axis.title = element_text(margin=margin(10, 5, 0, 0),
color = "black",size = font.size),
axis.title.y = element_text(angle=90))
p3<-data %>%
## 按照p值排序，选区既定数目的行
arrange(Pvalue) %>%
slice(1:showCategory) %>%
## 开始ggplot2 作图，其中fct_reorder调整因子level的顺序
ggplot(aes(GeneRatio,forcats::fct_reorder(Term,Count)))+
## 画出点图
geom_point(aes(color=Pvalue, size = Count)) +
## 调整颜色，guide_colorbar调整色图的方向
scale_color_continuous(low="red", high="blue", guide=guide_colorbar(reverse=TRUE))+
## 调整泡泡的大小
scale_size_continuous(range=c(3, 8))+ ### 这里可以改点的大小
## 如果用ylab("")或出现左侧空白
labs(y=NULL) +
## 如果没有这一句，上方会到顶
ggtitle("")+
## 设定主题
theme_bw() +
theme(axis.text.x = element_text(colour = "black",
size = font.size, vjust =1 ),
axis.text.y = element_text(colour = "black",
size = font.size, hjust =1 ),
axis.title = element_text(margin=margin(10, 5, 0, 0),
color = "black",size = font.size),
axis.title.y = element_text(angle=90))
p3 +
scale_x_discrete(labels=function(x) str_wrap(x, width=30))
p3 +
scale_x_discrete(labels=function(x) str_wrap(x, width=30)) +facet_grid(group~., scale = "free")
