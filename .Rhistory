library(ggVennDiagram)
ggVennDiagram(list)
suppressMessages(library(yyplot))
ggvenn(fromList(list))
install.packages("venneuler")
blogdown:::preview_site()
View(data2)
View(list)
knitr::kable(head(data2),caption = "六组基因列表的集合")
DT::datatable(data2)
DT::datatable(head(data2))
rm(list = ls())
blogdown:::serve_site()
blogdown::stop_server()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
install.packages("rticles")
install.packages("officedown")
blogdown:::new_post_addin()
install.packages("xaringan")
install.packages("xaringanthemer")
blogdown::stop_server()
blogdown:::serve_site()
BiocManager::install("TCGAbiolinks")
install.packages("UCSCXenaShiny")
library(UCSCXenaShiny)
app_run()
install.packages("pacman")
install.packages("pacman")
remove.packages("UCSCXenaShiny")
remove.packages("UCSCXenaTools")
blogdown:::serve_site()
blogdown::stop_server()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown::stop_server()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown::stop_server()
blogdown:::serve_site()
blogdown:::new_post_addin()
install.packages("pagedown")
blogdown:::serve_site()
blogdown:::new_post_addin()
library(readr)
demo <- read_csv("content/zh/course/2021-10-05-ggplot2-volcano/demo.csv")
View(demo)
DT::datatable(demo,caption = "Demo数据")
demo <- read_csv("/Users/mac/Documents/GitHub/Rblog/content/zh/course/2021-10-05-ggplot2-volcano/demo.csv")
DT::datatable(demo,caption = "Demo数据")
DT::datatable(head(demo),caption = "Demo数据")
suppressMessages(DT::datatable(demo,caption = "Demo数据"))
DT::datatable(demo,caption = "Demo数据",serverSide = TRUE, processing = TRUE)
demo<-na.omit(demo)
demo<-[!duplicated(demo)]
demo<-[!duplicated(demo$Gene.symbol)]
demo<-demo[!duplicated(demo$Gene.symbol)]
demo<-demo[!duplicated(demo)]
demo<-demo$Gene.symbol[!duplicated(demo$Gene.symbol)]
demo
demo <- read_csv("/Users/mac/Documents/GitHub/Rblog/content/zh/course/2021-10-05-ggplot2-volcano/demo.csv")
data <- demo[!duplicated(demo$Gene.symbol),]
remove(data)
demo<-na.omit(demo)
demo<-demo[!duplicated(demo$Gene.symbol),]
DT::datatable(demo,caption = "Demo数据")
knitr::kables(demo[10,])
demo[10,]
knitr::kables(demo[,10])
knitr::kables(demo[1:10,])
demo[1:10,]
DT::datatable(demo[1:10,],caption = "Demo数据")
DT::datatable(demo[1:50,],caption = "Demo数据")
library(ggplot2)
logFC_t <- with(demo,mean(abs(logFC)) + 2*sd(abs(logFC)))
## 这里使用的是动态阈值，也可以自定义例如logFC=1或2这种静态阈值
logFC_t <- round(logFC_t, 2) # 取前两位小数，这步也可以不运行
# 确定上下调表达基因
demo$change = as.factor(ifelse(demo$adj.P.Val < 0.05 & abs(demo$logFC) > logFC_t,
ifelse(demo$logFC > logFC_t ,'UP','DOWN'),'STABLE'))
logFC_t
table(DEG$change)
table(demo$change)
logFC_t <- with(demo,mean(abs(logFC)) + 2*sd(abs(logFC)))
this_tile <- paste0('Volcano plot for demo',
'\nCutoff for Log2FC is ',round(logFC_t,3),
'\nThe number of up genes is ',nrow(demo[demo$change =='UP',]) ,
'\nThe number of down genes is ',nrow(demo[demo$change =='DOWN',])
)
this_tile
ggplot(demo, aes(x=logFC, y=-log10(adj.P.Val),color=change)) +
geom_point(alpha=0.4, size=2) +
theme_classic() +
xlab("Log2(Fold change)") +
ylab("-Log10(P.adj)") +
theme(plot.title = element_text(size=15,hjust = 0.5)) +
scale_colour_manual(values = c('steelblue','gray','brown')) +
geom_hline(yintercept = -log10(0.05), lty = 4) +
geom_vline(xintercept = c(-logFC_t, logFC_t), lty = 4)+
labs(title = this_tile)
demo$label <- ifelse(demo$adj.P.Val< 0.0005& abs(demo$logFC) >= 2,demo$symbol,"")
demo$label <- ifelse(demo$adj.P.Val< 0.0005& abs(demo$logFC) >= 2,demo$Gene.symbol,"")
demo$label
DT::datatable(demo[1:15,])
ggplot(demo, aes(x=logFC, y=-log10(adj.P.Val),color=Change)) +
geom_point(alpha=0.4, size=2) +
theme_bw(base_size = 12) +
xlab("Log2(Fold change)") +
ylab("-Log10(P.adj)") +
theme(plot.title = element_text(size=15,hjust = 0.5)) +
scale_colour_manual(values = c('steelblue','gray','brown')) +
geom_hline(yintercept = -log10(0.05), lty = 4) +
geom_vline(xintercept = c(-logFC_t, logFC_t), lty = 4)+
labs(title = this_tile)+
geom_label_repel(data = DEG, aes(label = label),
size = 3,box.padding = unit(0.5, "lines"),
point.padding = unit(0.8, "lines"),
segment.color = "black",
show.legend = FALSE, max.overlaps = 10000)
library(ggrepel)
demo$Change = as.factor(ifelse(demo$adj.P.Val < 0.05 & abs(demo$logFC) > logFC_t,
ifelse(demo$logFC > logFC_t ,'UP','DOWN'),'STABLE'))
ggplot(demo, aes(x=logFC, y=-log10(adj.P.Val),color=Change)) +
geom_point(alpha=0.4, size=2) +
theme_bw(base_size = 12) +
xlab("Log2(Fold change)") +
ylab("-Log10(P.adj)") +
theme(plot.title = element_text(size=15,hjust = 0.5)) +
scale_colour_manual(values = c('steelblue','gray','brown')) +
geom_hline(yintercept = -log10(0.05), lty = 4) +
geom_vline(xintercept = c(-logFC_t, logFC_t), lty = 4)+
labs(title = this_tile)+
geom_label_repel(data = DEG, aes(label = label),
size = 3,box.padding = unit(0.5, "lines"),
point.padding = unit(0.8, "lines"),
segment.color = "black",
show.legend = FALSE, max.overlaps = 10000)
ggplot(demo, aes(x=logFC, y=-log10(adj.P.Val),color=Change)) +
geom_point(alpha=0.4, size=2) +
theme_bw(base_size = 12) +
xlab("Log2(Fold change)") +
ylab("-Log10(P.adj)") +
theme(plot.title = element_text(size=15,hjust = 0.5)) +
scale_colour_manual(values = c('steelblue','gray','brown')) +
geom_hline(yintercept = -log10(0.05), lty = 4) +
geom_vline(xintercept = c(-logFC_t, logFC_t), lty = 4)+
labs(title = this_tile)+
geom_label_repel(data = demo, aes(label = label),
size = 3,box.padding = unit(0.5, "lines"),
point.padding = unit(0.8, "lines"),
segment.color = "black",
show.legend = FALSE, max.overlaps = 10000)
ggpubr::ggscatter(demo, x = "logFC", y = "adj.P.Val", color = "Change",size = 0.5, repel = T,
label.select =head(demo$label),
palette = c("#00AFBB", "#E7B800", "#FC4E07") ))
ggpubr::ggscatter(demo,"logFC","adj.P.val",color = "Change")
library(ggpubr)
ggscatter(demo, x = "logFC", y = "P.Value", color = "Change",
palette = c("#00AFBB", "#E7B800", "#FC4E07") )
ggscatter(demo, x = "logFC", y = "adj.P.Val", color = "Change",palette = c("#00AFBB", "#E7B800", "#FC4E07") )
ggscatter(demo, x = "logFC", y = "adj.P.Val", color = "Change",
repel = T,
label.select =head(demo$Gene.symbol),
palette = c("#00AFBB", "#E7B800", "#FC4E07") )
demo$p = -log10(demo$adj.P.Val)
ggscatter(demo, x = "logFC", y = "p", color = "Change",size = 0.5, repel = T,
palette = c("#00AFBB", "#E7B800", "#FC4E07") )
ggscatter(demo, x = "logFC", y = "p", color = "Change",size = 0.5, repel = T,
palette = c('steelblue','gray','brown') )
ggscatter(demo, x = "logFC", y = "p", color = "Change",size = 0.5,
palette = c('steelblue','gray','brown') )
ggscatter(demo, x = "logFC", y = "p", color = "Change",size = 0.5, repel = T,label = "Gene.symbol", repel = T,
label.select =head(demo$Gene.symbol),
palette = c('steelblue','gray','brown') )
ggscatter(demo, x = "logFC", y = "p", color = "Change",size = 0.5, label = "Gene.symbol", repel = T,
label.select =head(demo$Gene.symbol),
palette = c('steelblue','gray','brown') )
ggscatter(demo, x = "logFC", y = "p", color = "Change",size = 0.5, label = "label", repel = T,
label.select =head(demo$label),
palette = c('steelblue','gray','brown') )
ggscatter(demo, x = "logFC", y = "p", color = "Change",size = 0.5,
palette = c('steelblue','gray','brown') )
ggscatter(demo, x = "logFC", y = "p", color = "Change",size = 0.5,
palette = c('steelblue','gray','brown') )+geom_hline(yintercept = -log10(0.05), lty = 4) +
geom_vline(xintercept = c(-logFC_t, logFC_t), lty = 4)
ggscatter(demo, x = "logFC", y = "p", color = "Change",size = 0.5,
palette = c('steelblue','gray','brown'),ggtheme = theme_bw() )+geom_hline(yintercept = -log10(0.05), lty = 4) +
geom_vline(xintercept = c(-logFC_t, logFC_t), lty = 4)
ggscatter(demo, x = "logFC", y = "p", color = "Change",size = 0.5,
palette = c('steelblue','gray','brown'),ggtheme = theme_bw() )+geom_hline(yintercept = -log10(0.05), lty = 4) +
geom_vline(xintercept = c(-logFC_t, logFC_t), lty = 4)+ labs(title = this_tile)
blogdown:::new_post_addin()
rm(list = ls())
blogdown:::new_post_addin()
blogdown:::new_post_addin()
blogdown:::serve_site()
data<-read.csv("/Users/mac/Documents/GitHub/我的硕士论文/data.csv")
data<-as.data.frame(data)
View(data)
data2<-data %>%
mutate(location=factor(location,labels = c("Left","Right")))
data<-data %>%
mutate(location=factor(location,labels = c("Left","Right")))
remove(data2)
View(data)
library(epiDisplay)
summ(data)
summ(data2)[["table"]]
summ(data)[["table"]]
summ(data)
library(psych)
describeBy(data,data$group)
rm(list = ls())
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
library(magick)
x<-image_read('/Users/mac/Documents/pic.jpg')
x
ggplotify::as.ggplot(x)
y<-image_fill(x,'white',fuzz = 20)
y
ggplotify::as.ggplot(y)
ggplotify::as.ggplot(image_fill(x,'green',fuzz = 20))
ggplotify::as.ggplot(image_fill(x,'steelblue',fuzz = 20))
ggplotify::as.ggplot(image_fill(x,'brown',fuzz = 20))
ggplotify::as.ggplot(image_fill(x,'blue',fuzz = 20))
ggplotify::as.ggplot(image_fill(x,'black',fuzz = 20))
ggplotify::as.ggplot(image_fill(x,'pink',fuzz = 20))
ggplotify::as.ggplot(image_fill(x,'purple',fuzz = 20))
blogdown:::new_post_addin()
library(clusterProfiler)
knitr::include_graphics("/content/zh/course/2021-10-12-ggfun")
knitr::include_graphics("/content/zh/course/2021-10-12-ggfun/go.jpg")
knitr::include_graphics("/content/zh/course/2021-10-12-ggfun/go.jpg")
knitr::include_graphics("/Users/mac/Documents/GitHub/Rblog/content/zh/course/2021-10-12-ggfun/go.jpg")
blogdown:::preview_site()
ggplot(mpg, aes(displ, cty)) + geom_point()
library(ggfun)
library(ggplot2)
ggplot(mpg, aes(displ, cty)) + geom_point()
ggplot(mpg, aes(displ, cty)) + geom_point()+facet_grid(cols = vars(cyl))+ theme(strip.background=element_roundrect(fill="grey40", color=NA, r=0.15))
ggplot(mpg, aes(displ, cty)) + geom_point()+facet_grid(cols = vars(cyl))+
）
ggplot(mpg, aes(displ, cty)) + geom_point()+facet_grid(cols = vars(cyl))
blogdown:::new_post_addin()
install.packages("ggplotAssist")
d <- data.frame(x=rnorm(10), y=rnorm(10), lab=LETTERS[1:10])
p <- ggplot(d, aes(x, y)) + geom_text(aes(label=lab), size=5)
set_font(p, family="Times", fontface="italic", color='firebrick')
ggplot(mtcars, aes(mpg, disp)) + geom_point()
rm(list = ls())
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
install.packages("ymlthis")
xaringan:::inf_mr()
ymlthis:::launch_yaml_addin()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::new_post_addin()
rm(list = ls())
install.packages("GGally")
library(corrplot)
data(mtcars)
force(mtcars)
library(corrplot)
data(mtcars)
DT::datatable(mtcars)
cor(mtcars)
M <- cor(mtcars)
DT::datatable(M)
round(M,3)
blogdown:::new_post_addin()
blogdown:::new_post_addin()
library(ggcorrplot)
p.mat <- cor_pmat(mtcars)
View(p.mat)
rm(list = ls())
blogdown:::new_post_addin()
data(mtcars)
force(mtcars)
View(mtcars)
ggcorr(mtcars)
library(GGally)
ggcorr(mtcars)
ggcorr(mtcars, geom = "blank", label = TRUE, hjust = 0.75) +
geom_point(size = 10, aes(color = coefficient > 0, alpha = abs(coefficient) > 0.5)) +
scale_alpha_manual(values = c("TRUE" = 0.25, "FALSE" = 0)) +
guides(color = FALSE, alpha = FALSE)
ggcorr(mtcars,
label = TRUE,
digits = 2, # 设置小数位数
label_alpha = 0.8, # 设置透明度
label_color = "steelblue", # 设置文本颜色
label_size =2.6)
ggcorr(mtcars,
label = TRUE,
digits = 2, # 设置小数位数
label_alpha = 0.8, # 设置透明度
label_color = "steelblue", # 设置文本颜色
label_size = 3.6)
ggcorr(mtcars,
label = TRUE,
digits = 2, # 设置小数位数
label_alpha = 0.8, # 设置透明度
label_color = "steelblue", # 设置文本颜色)
）
ggcorr(mtcars,
label = TRUE,
digits = 2, # 设置小数位数
label_alpha = 0.8, # 设置透明度
label_color = "steelblue", # 设置文本颜色
)
blogdown:::new_post_addin()
data(iris)
force(iris)
View(iris)
blogdown:::serve_site()
blogdown:::new_post_addin()
library(UpSetR)
list<-read.csv('/Users/mac/Desktop/2021院级课题/GEO/raw/alldown.csv')
View(list)
list<-read.csv('/Users/mac/Desktop/2021院级课题/GEO/raw/alldown.csv')
DT::datatable(list)
remove(list )
list<-read.csv('/Users/mac/Documents/GitHub/Rblog/content/zh/course/2021-10-23-upsetr/list.csv')
DT::datatable(list)
library(UpSetR)
upset(fromList(list))
library(UpSetR)
upset(fromList(list),order.by = 'freq')
upset(fromList(list),
nsets = dim(fromList(list_down))[1],
order.by = 'freq'）
upset(fromList(list),
nsets = dim(fromList(list))[1],
order.by = 'freq'）
upset(fromList(list),
nsets = dim(fromList(list))[1],
order.by = 'freq'）
upset(fromList(list),
nsets = dim(fromList(list))[1],
order.by = 'freq'）
dim(fromList(list))[1]
upset(fromList(list),
nsets = dim(fromList(list))[2],
order.by = 'freq'）
upset(fromList(list),
nsets = dim(fromList(list))[2]）
upset(fromList(list),
nsets = dim(fromList(list))[2],
order.by = 'freq')
upset(fromList(list),
nsets = dim(fromList(list))[2],keep.order = T,
order.by = 'freq')
upset(fromList(list),
nsets = dim(fromList(list))[2],keep.order = T
)
upset(fromList(list),
nsets = dim(fromList(list))[2],
order.by = 'freq'，
upset(fromList(list),
nsets = dim(fromList(list))[2],
order.by = 'freq',
queries = list(list(query = intersects,
params = list(colnames(fromList(list_down))),
active = T)))
upset(fromList(list),
nsets = dim(fromList(list))[2],
order.by = 'freq',
queries = list(list(query = intersects,
params = list(colnames(fromList(list))),
active = T)))
upset(fromList(list),
nsets = dim(fromList(list))[2],
order.by = 'freq',
empty.intersections = 'on',
queries = list(list(query = intersects,
params = list(colnames(fromList(list))),
active = T)))
upset(fromList(list),
nsets = dim(fromList(list))[2],
order.by = 'freq',
empty.intersections = 'on',
set_size.show = T,
queries = list(list(query = intersects,
params = list(colnames(fromList(list))),
active = T)))
upset(fromList(list),
nsets = dim(fromList(list))[2],
order.by = 'freq',
empty.intersections = 'on',
set_size.show = T,
main.bar.color = "brown", # 设置交集数柱子的颜色
sets.bar.color = ggpubr::get_palette('npg',6), ## 设置数据集颜色，选择ggpubr的配色
queries = list(list(query = intersects,
params = list(colnames(fromList(list))),
active = T)))
blogdown:::new_post_addin()
remove(list)
geo120736 = geo_download("GSE120736",
destdir=tempdir(),
by_annopbrobe = T  ### 默认为F，设置为T调用AnnoProbe
)
library(tinyarray)
geo120736 = geo_download("GSE120736",
destdir=tempdir(),
by_annopbrobe = T  ### 默认为F，设置为T调用AnnoProbe
)
### AnnoProbe是国内的一个GEO镜像，不过有些数据没有收录，因此有些GSE提示不存在，这种情况下只能设置by_annopbrobe = F
boxplot(geo120736$exp)
View(geo120736)
boxplot(geo120736) [,-c(1:50)]
boxplot(geo120736$exp) [,-c(1:50)]
range(geo120736$exp)
ex <- geo120736$exp
qx <- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))
LogC <- (qx[5] > 100) ||
(qx[6]-qx[1] > 50 && qx[2] > 0) ||
(qx[2] > 0 && qx[2] < 1 && qx[4] > 1 && qx[4] < 2)
if (LogC) { ex[which(ex <= 0)] <- NaN
geo120736$exp<- log2(ex)
print("log2 transform finished")}else{print("log2 transform not needed")}
remove(ex,qx,LogC)  # 删除多余的
ph120736 <-geo120736$pd
ph120736 <-geo120736$pd
DT::datatable(ph120736)
ph120736 <-geo120736$pd
DT::datatable(head(ph120736))
View(ph120736)
remove(geo120736,ph120736)
blogdown:::serve_site()
library(ggplot2)
library(ComplexUpset)
movies = as.data.frame(ggplot2movies::movies)
install.packages("ggplot2movies")
movies = as.data.frame(ggplot2movies::movies)
View(movies)
head(movies, 3)
genres = colnames(movies)[18:24]
genres
movies[genres] = movies[genres] == 1
t(head(movies[genres], 3))
View(movies)
movies[movies$mpaa == '', 'mpaa'] = NA
movies = na.omit(movies)
set_size = function(w, h, factor=1.5) {
s = 1 * factor
options(
repr.plot.width=w * s,
repr.plot.height=h * s,
repr.plot.res=100 / factor,
jupyter.plot_mimetypes='image/png',
jupyter.plot_scale=1
)
}
set_size(8, 3)
upset(movies, genres, name='genre', width_ratio=0.1)
upset(movies, genres)
upset(movies, genres, name='genre', width_ratio=0.1)
upset(movies, genres)
blogdown:::serve_site()
data(aSAH)
library(pROC)
data(aSAH)
force(aSAH)
View(aSAH)
oc(aSAH$outcome, aSAH$s100b,
levels=c("Good", "Poor"))
roc(aSAH$outcome, aSAH$s100b,
levels=c("Good", "Poor"))
roc(aSAH$outcome, aSAH$s100b)
roc(outcome ~ s100b, aSAH)
roc(outcome ~ s100b, data=aSAH)
roc(aSAH$outcome, aSAH$s100b, smooth=TRUE)
roc(aSAH$outcome, aSAH$s100b)
plot(roc(aSAH$outcome, aSAH$s100b))
ggroc(roc(aSAH$outcome, aSAH$s100b))
plot(roc(aSAH$outcome, aSAH$s100b))
ggroc(list(s100b=rocobj, wfns=rocobj2, ndka=roc(aSAH$outcome, aSAH$ndka)))
ggroc(list(s100b=rocobj, wfns=roc(aSAH$outcome, aSAH$wfns), ndka=roc(aSAH$outcome, aSAH$ndka)))
ggroc(list(s100b=roc(aSAH$outcome, aSAH$s100b), wfns=roc(aSAH$outcome, aSAH$wfns), ndka=roc(aSAH$outcome, aSAH$ndka)))
ggroc(list(s100b=roc(aSAH$outcome, aSAH$s100b), wfns=roc(aSAH$outcome, aSAH$wfns), ndka=roc(aSAH$outcome, aSAH$ndka)))+ggplot2::theme_bw()
library(readxl)
ROC曲线 <- read_excel("~/Desktop/ROC曲线.xlsx")
View(ROC曲线)
ggroc(list(a=roc(ROC曲线$outcome,ROC曲线$a), b=roc(ROC曲线$outcome,ROC曲线$b), c=roc(ROC曲线$outcome,ROC曲线$c)))+ggplot2::theme_bw()
ggroc(list(a=roc(ROC曲线$outcome,ROC曲线$a), b=roc(ROC曲线$outcome,ROC曲线$b), c=roc(ROC曲线$outcome,ROC曲线$c)),linetype=4)+ggplot2::theme_bw()
ggroc(roc(outcome~a+b+c,data=ROC曲线))
ggroc(roc(outcome~a+b+c,data=ROC曲线,auc=T))
ggroc(roc(outcome~a+b+c,data=ROC曲线,auc=T))+facet_grid(.~name)
ggroc(roc(outcome~a+b+c,data=ROC曲线,auc=T))+ggplot2::facet_grid(.~name)
ggroc(roc(outcome~a+b+c,data=ROC曲线,smooth=T))+ggplot2::facet_grid(.~name)
ggroc(roc(outcome~a+b+c,data=ROC曲线,add=T))+ggplot2::facet_grid(.~name)
ggroc(roc(outcome~a+b+c,data=ROC曲线,AUC=T,ci=T,plot=T,add=T))+ggplot2::facet_grid(.~name)
ggroc(roc(outcome~a+b+c,data=ROC曲线,auc=T,ci=T))
ggroc(roc(outcome~a+b+c,data=ROC曲线,auc=T,ci=T,plot=T))
View(ROC曲线)
ggpubr::ggboxplot(aSAH,'outcome','wfns',add = 'jitter',color = 'outcome')
ggpubr::ggboxplot(aSAH,'outcome','wfns',color = 'outcome')
ggpubr::ggboxplot(aSAH,'outcome','s100b',color = 'outcome')
ggpubr::ggboxplot(aSAH,'outcome','s100b',color = 'outcome',add = 'jitter')
blogdown:::serve_site()
blogdown:::serve_site()
